name: Telegram Auto Video Post

on:
  workflow_dispatch:
  schedule:
    # KST(한국시간) 기준: 매 2시간마다(00,02,04,...). GitHub cron은 UTC 기준이라 변환한 값
    - cron: '0 15-23/2,1-13/2 * * *'

jobs:
  post:
    runs-on: ubuntu-latest
    steps:
      - name: Send video by file_id
        env:
          TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          VIDEO_FILE_ID: ${{ secrets.TELEGRAM_VIDEO_FILE_ID }}
          CAPTION: ${{ secrets.TELEGRAM_CAPTION }}
        run: |
          curl -sS -X POST "https://api.telegram.org/bot${TOKEN}/sendVideo" \
            -d "chat_id=${CHAT_ID}" \
            -d "video=${VIDEO_FILE_ID}" \
            --data-urlencode "caption=${CAPTION}"
